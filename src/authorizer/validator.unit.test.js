/* cSpell:disable */
// to test, use: yarn test:w ./src/authorizer

import validator from './validator'

const expiredToken = 'eyJraWQiOiJiT0M3eWRkS2hleXZGVnp3VlNsczVPd1JTbENySHF3TzA3RHlGUVBiMk9JPSIsImFsZyI6IlJTMjU2In0.eyJzdWIiOiI4MDYzNjY0Mi0zZTcxLTRjNTctOWQ2MS02YmYwNzFiYjg5ZTEiLCJjb2duaXRvOmdyb3VwcyI6WyJhZG1pbiJdLCJ0b2tlbl91c2UiOiJhY2Nlc3MiLCJzY29wZSI6ImF3cy5jb2duaXRvLnNpZ25pbi51c2VyLmFkbWluIiwiYXV0aF90aW1lIjoxNTYwOTY3NDg1LCJpc3MiOiJodHRwczpcL1wvY29nbml0by1pZHAuY2EtY2VudHJhbC0xLmFtYXpvbmF3cy5jb21cL2NhLWNlbnRyYWwtMV8xRFFqblU2amQiLCJleHAiOjE1NjEwNDMwNjYsImlhdCI6MTU2MTAzOTQ2NiwianRpIjoiY2I4ODI4MmUtMzE3OC00ZGJiLWJlOGEtYmNkYzJiYTliNDI3IiwiY2xpZW50X2lkIjoiMjA3NWtiYmJiM2hhZG10YWxlZGNuY2ZiazAiLCJ1c2VybmFtZSI6InB1bHBmcmVlIn0.f-PmXyLsfC0sX9t4Oj7AyZmlGjX0J2crCM1wfEQ_AcuWniW9y_QUGrrWdefWjcSXpsvNUg-ZjMPmTyHKuVlsi9B44fbpg_nX1oZODgzXqP_IeoJ0TwvXU1eWVOG-CGO6ktaRYn1WqNQqr1XIoV5BoDapYQjO64kYdmaK3_6Xz9QBi4PrZ3TCzA8tlNik5zZcsy1VAzlCqyuNPTu662R8228I65f48pJr1FoZbTQk7bFIp9CiPl6cJLRCALNcaI2AbWquqpY_nWUOMClfppeoz3rE0u3pa_PBNRVAoO1PIpU_SRdaw1DmxagFLz5XSr5uFv0TV0jlGkLs_wWo92Ek3Q'
// note: require a fresh token here to properly test
const token = 'eyJraWQiOiJmTVlINkJyRHB3T2ZaOUVsNkZkM0N1UCtsME1kTFpLd3gwaUk5VXhOU0RnPSIsImFsZyI6IlJTMjU2In0.eyJzdWIiOiI1ZjlhZTcxZS1iZmRiLTRhYzctOGVhNy1kMTU2ZTdmMmEzODAiLCJkZXZpY2Vfa2V5IjoidXMtZWFzdC0xX2RkYmZiMWJkLTlhOWQtNDM5Yy1iNDQzLTMzZDE3MzZlY2ZjZCIsInRva2VuX3VzZSI6ImFjY2VzcyIsInNjb3BlIjoiYXdzLmNvZ25pdG8uc2lnbmluLnVzZXIuYWRtaW4iLCJhdXRoX3RpbWUiOjE1NjgxMjUwODYsImlzcyI6Imh0dHBzOlwvXC9jb2duaXRvLWlkcC51cy1lYXN0LTEuYW1hem9uYXdzLmNvbVwvdXMtZWFzdC0xX2dzQjU5d2Z6VyIsImV4cCI6MTU2OTI2MjgyMywiaWF0IjoxNTY5MjU5MjI0LCJqdGkiOiJmYWE4MmUyNy04YzY3LTQ2NDUtOWY1Yy02YmY1MDgwZDk1NGUiLCJjbGllbnRfaWQiOiIyMDg0dWtzbHNjODMxcHQyMDJ0MmR1ZHQ3YyIsInVzZXJuYW1lIjoicHVscGZyZWUifQ.TAszP6zU1f29KIn70PWGzBb0S7UmWc_1mDdGAwKL2nDV1A2lvU4qHqvgs0cqDETQARkF-pjnUK-d3LC6ReUQImr-Xmy0PeJSskO3UkhzDbDQ6eokulA5FNjw7crAW47DxOjTfCC2t8U6xK9jKxbyDGGNGG3WxT9LXL4SLYGJ4Is9enHrnuqvxbv0vtpZ5igxayWACT-gK6-ES9Is54TwBNGB6s7PngJbLm7WKSeN1CWsb2qklFJg7rYpyj23rRe7lW7GHl7UfiQPn7vHSoxBpEDD1buydknajkLqLTLEi54yEq2sdRtk75y80NPj6puAGRZT-juezktST_4gvo-Viw'
const clientID = '2084ukslsc831pt202t2dudt7c'
const invalidClientID = '2075kbbbb3hadmtaledcncfbk9'


test('authCheck expired token', async () => {
  const res = await validator(clientID, expiredToken)
  expect(res.status).toEqual('unauthorized')
})

test('authCheck invalid clientID', async () => {
  const res = await validator(invalidClientID, token)
  expect(res.status).toEqual('deny')
})

test('authCheck allow', async () => {
  const res = await validator(clientID, token)
  expect(res.status).toEqual('allow')
})
